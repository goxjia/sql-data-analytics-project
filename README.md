# SQL Data Analysis and Reporting Repository

This repository offers a comprehensive collection of SQL scripts designed for in-depth data exploration, analytics, and reporting within a relational database. It's a valuable resource for data analysts and BI professionals seeking to quickly explore, segment, and analyze data effectively. Each script focuses on a specific analytical theme and demonstrates best practices for SQL queries.

## Table of Contents

1.  [Dimensions Exploration](#1-dimensions-exploration)
2.  [Date Range Exploration](#2-date-range-exploration)
3.  [Measures Exploration (Key Metrics)](#3-measures-exploration-key-metrics)
4.  [Magnitude Analysis](#4-magnitude-analysis)
5.  [Ranking Analysis](#5-ranking-analysis)
6.  [Change Over Time Analysis](#6-change-over-time-analysis)
7.  [Cumulative Analysis](#7-cumulative-analysis)
8.  [Performance Analysis (Year-over-Year, Month-over-Month)](#8-performance-analysis-year-over-year-month-over-month)
9.  [Data Segmentation Analysis](#9-data-segmentation-analysis)
10. [Part-to-Whole Analysis](#10-part-to-whole-analysis)
11. [Product Report (`report_products`)](#11-product-report-report_products)
12. [Customer Report (`report_customers`)](#12-customer-report-report_customers)

---

## Breakdown of Insights and Analyses

Here's a detailed overview of the analyses performed by the SQL scripts in this repository:

### 1. Dimensions Exploration

This section focuses on understanding the unique values within dimension tables, providing foundational insights into your data's categorical structure.

* **Customer Countries**: Retrieves a distinct list of countries from which customers originate.
* **Product Categories**: Lists unique combinations of category, subcategory, and product names.

### 2. Date Range Exploration

This section determines the temporal boundaries of your key data points, helping you understand the historical data's range.

* **Order Dates**: Identifies the earliest and latest order dates and calculates the total duration in months between them.
* **Customer Birthdates**: Finds the oldest and youngest customer birthdates and calculates their current ages.

### 3. Measures Exploration (Key Metrics)

This section calculates aggregated metrics for quick insights into overall trends and potential anomalies.

* **Total Sales**: Calculates the sum of all sales amounts.
* **Total Quantity Sold**: Determines the total number of items sold.
* **Average Selling Price**: Computes the average price of all sales.
* **Total Number of Orders**: Counts the total number of distinct orders.
* **Total Products**: Counts the total number of unique products.
* **Total Customers**: Counts the total number of customers in the dimension table and also the total number of customers who have placed an order.
* **Key Business Metrics Report**: Generates a consolidated report showing all key metrics, including total sales, total quantity, average price, total orders, total products, and total customers.

### 4. Magnitude Analysis

This section quantifies data and groups results by specific dimensions, ideal for understanding data distribution across categories.

* **Customers by Country**: Counts the total customers per country.
* **Customers by Gender**: Counts the total customers per gender.
* **Products by Category**: Counts the total products within each category.
* **Average Cost by Category**: Calculates the average cost of products for each category.
* **Revenue by Category**: Determines the total revenue generated for each product category.
* **Revenue by Customer**: Calculates the total revenue generated by each individual customer.
* **Sold Items by Country**: Shows the distribution of sold items across different countries.

### 5. Ranking Analysis

This section ranks items (e.g., products, customers) based on performance or other metrics, helping to identify top performers or laggards.

* **Top 5 Products by Revenue**: Identifies the top 5 products generating the highest revenue using both `TOP` and window functions like `RANK()`.
* **Worst 5 Products by Sales**: Finds the 5 worst-performing products in terms of sales.
* **Top 10 Customers by Revenue**: Lists the top 10 customers who have generated the highest revenue.
* **Customers with Fewest Orders**: Identifies the 3 customers who have placed the fewest orders.

### 6. Change Over Time Analysis

This section tracks trends, growth, and changes in key metrics over time, essential for time-series analysis and identifying seasonality.

* **Sales Performance Over Time**: Analyzes total sales, total customers, and total quantity over time, aggregated by year and month using `YEAR()`/`MONTH()`, `DATETRUNC()`, and `FORMAT()` functions.

### 7. Cumulative Analysis

This section calculates running totals or moving averages for key metrics to track performance cumulatively, useful for growth analysis or identifying long-term trends.

* **Running Total and Moving Average Sales**: Calculates the total sales per year, the running total of sales, and the moving average price over time.

### 8. Performance Analysis (Year-over-Year, Month-over-Month)

This section measures the performance of products over time by comparing current sales to average sales and previous year's sales, ideal for benchmarking and identifying high-performing entities.

* **Yearly Product Performance**: Analyzes product sales by year, comparing `current_sales` to `avg_sales` (partitioned by product) and `py_sales` (previous year's sales) using `LAG()`. It also includes a `CASE` statement to indicate whether sales are "Above Avg", "Below Avg", "Increase", "Decrease", or "No Change".

### 9. Data Segmentation Analysis

This section groups data into meaningful categories for targeted insights, enabling customer segmentation, product categorization, or regional analysis.

* **Product Cost Segmentation**: Segments products into cost ranges ('Below 100', '100-500', '500-1000', 'Above 1000') and counts the number of products in each segment.
* **Customer Spending Segmentation**: Groups customers into "VIP", "Regular", and "New" segments based on their spending behavior and lifespan, then counts the total customers in each group. VIP customers have at least 12 months of history and spend more than €5,000; Regular customers have at least 12 months of history and spend €5,000 or less; New customers have a lifespan of less than 12 months.

### 10. Part-to-Whole Analysis

This section compares performance or metrics across dimensions to evaluate differences between categories, useful for A/B testing or regional comparisons.

* **Category Contribution to Overall Sales**: Calculates each category's total sales, the overall total sales, and the percentage contribution of each category to the overall sales.

### 11. Product Report (`report_products`)

This SQL view provides a comprehensive and consolidated view of product performance and characteristics.

**Purpose:**
* To consolidate key product metrics and behaviors.

**Highlights:**
* Gathers essential fields such as product name, category, subcategory, and cost.
* Segments products by revenue into 'High-Performers' (total sales > €50,000), 'Mid-Range' (€10,000 <= total sales <= €50,000), or 'Low-Performers' (total sales < €10,000).
* Aggregates product-level metrics including:
    * Total orders
    * Total sales
    * Total quantity sold
    * Total unique customers
    * Lifespan (in months, from first to last order date)
    * Average selling price
* Calculates valuable Key Performance Indicators (KPIs):
    * Recency (months since last sale)
    * Average Order Revenue (AOR)
    * Average Monthly Revenue

### 12. Customer Report (`report_customers`)

This SQL view offers detailed insights into customer behavior and demographics.

**Purpose:**
* To consolidate key customer metrics and behaviors.

**Highlights:**
* Gathers essential fields such as customer name, age, and transaction details.
* Segments customers into:
    * **Age Groups**: 'Under 20', '20-29', '30-39', '40-49', and '50 and above'.
    * **Customer Categories**: 'VIP' (lifespan >= 12 months AND total sales > €5,000), 'Regular' (lifespan >= 12 months AND total sales <= €5,000), or 'New' (lifespan < 12 months).
* Aggregates customer-level metrics including:
    * Total orders
    * Total sales
    * Total quantity purchased
    * Total products purchased
    * Lifespan (in months, from first to last order date)
* Calculates valuable Key Performance Indicators (KPIs):
    * Recency (months since last order)
    * Average order value (AOV)
    * Average monthly spend
